basePath: /api
definitions:
  models.AccountPnL:
    properties:
      account:
        type: string
      realized_pnl_usd:
        type: number
      realized_pnl_vnd:
        type: number
      total_pnl_usd:
        type: number
      total_pnl_vnd:
        type: number
      total_value_usd:
        type: number
      total_value_vnd:
        type: number
    type: object
  models.ActionRequest:
    properties:
      action:
        type: string
      params:
        additionalProperties: true
        type: object
    type: object
  models.ActionResponse:
    properties:
      action:
        type: string
      executed_at:
        type: string
      transactions:
        items:
          $ref: '#/definitions/models.Transaction'
        type: array
    type: object
  models.AssetPnL:
    properties:
      asset:
        type: string
      average_cost_usd:
        type: number
      current_quantity:
        type: number
      current_value_usd:
        type: number
      current_value_vnd:
        type: number
      realized_pnl_usd:
        type: number
      realized_pnl_vnd:
        type: number
      total_pnl_usd:
        type: number
      total_pnl_vnd:
        type: number
    type: object
  models.CashFlowByType:
    properties:
      count:
        type: integer
      inflow_usd:
        type: number
      inflow_vnd:
        type: number
      net_usd:
        type: number
      net_vnd:
        type: number
      outflow_usd:
        type: number
      outflow_vnd:
        type: number
    type: object
  models.CashFlowReport:
    properties:
      by_tag:
        additionalProperties:
          $ref: '#/definitions/models.CashFlowByType'
        type: object
      by_type:
        additionalProperties:
          $ref: '#/definitions/models.CashFlowByType'
        type: object
      combined_in_usd:
        description: Combined totals = Operating + Financing
        type: number
      combined_in_vnd:
        type: number
      combined_net_usd:
        type: number
      combined_net_vnd:
        type: number
      combined_out_usd:
        type: number
      combined_out_vnd:
        type: number
      financing_in_usd:
        description: Financing totals include borrow (as inflow), repay_borrow and
          interest_expense (as outflows)
        type: number
      financing_in_vnd:
        type: number
      financing_net_usd:
        type: number
      financing_net_vnd:
        type: number
      financing_out_usd:
        type: number
      financing_out_vnd:
        type: number
      net_usd:
        type: number
      net_vnd:
        type: number
      operating_in_usd:
        description: Operating totals exclude financing flows (borrow, repay_borrow,
          interest_expense)
        type: number
      operating_in_vnd:
        type: number
      operating_net_usd:
        type: number
      operating_net_vnd:
        type: number
      operating_out_usd:
        type: number
      operating_out_vnd:
        type: number
      period:
        $ref: '#/definitions/models.Period'
      total_in_usd:
        type: number
      total_in_vnd:
        type: number
      total_out_usd:
        type: number
      total_out_vnd:
        type: number
    type: object
  models.CostBasisMethod:
    enum:
    - fifo
    - lifo
    - average
    type: string
    x-enum-varnames:
    - CostBasisFIFO
    - CostBasisLIFO
    - CostBasisAverage
  models.Holding:
    properties:
      account:
        type: string
      asset:
        type: string
      id:
        type: string
      is_vault:
        type: boolean
      last_updated:
        type: string
      percentage:
        description: Percentage of total portfolio value
        type: number
      quantity:
        type: number
      value_usd:
        type: number
      value_vnd:
        type: number
    type: object
  models.HoldingSummary:
    properties:
      by_account:
        additionalProperties:
          items:
            $ref: '#/definitions/models.Holding'
          type: array
        type: object
      by_asset:
        additionalProperties:
          $ref: '#/definitions/models.Holding'
        type: object
      last_updated:
        type: string
      total_value_usd:
        type: number
      total_value_vnd:
        type: number
    type: object
  models.Investment:
    properties:
      account:
        type: string
      asset:
        type: string
      cost_basis_method:
        allOf:
        - $ref: '#/definitions/models.CostBasisMethod'
        description: Configuration
      created_at:
        description: Metadata
        type: string
      deposit_cost:
        description: Total cost in USD
        type: number
      deposit_date:
        description: Aggregated deposit information
        type: string
      deposit_qty:
        description: Total quantity deposited
        type: number
      deposit_unit_cost:
        description: Weighted average unit cost
        type: number
      horizon:
        type: string
      id:
        type: string
      is_migrated:
        type: boolean
      is_open:
        description: Status and quantities
        type: boolean
      pnl:
        description: P&L calculation
        type: number
      pnl_percent:
        type: number
      realized_pnl:
        description: Derived fields (not persisted)
        type: number
      remaining_qty:
        type: number
      updated_at:
        type: string
      vault_id:
        description: Vault migration fields
        type: string
      withdrawal_date:
        description: Withdrawal information (if closed)
        type: string
      withdrawal_qty:
        type: number
      withdrawal_unit_price:
        type: number
      withdrawal_value:
        type: number
    type: object
  models.InvestmentSummary:
    properties:
      closed_investments:
        type: integer
      open_investments:
        type: integer
      open_market_value:
        type: number
      realized_pnl:
        type: number
      roi_percent:
        type: number
      total_deposits:
        type: number
      total_investments:
        type: integer
      total_pnl:
        type: number
      total_withdrawals:
        type: number
      unrealized_pnl:
        type: number
    type: object
  models.OutflowProjection:
    properties:
      account:
        type: string
      as_of:
        type: string
      asset:
        type: string
      id:
        type: string
      interest_accrued:
        type: number
      remaining_principal:
        type: number
      total_outflow:
        type: number
    type: object
  models.OutstandingBorrow:
    properties:
      account:
        type: string
      amount:
        type: number
      asset:
        type: string
    type: object
  models.Period:
    properties:
      end_date:
        type: string
      start_date:
        type: string
    type: object
  models.PnLReport:
    properties:
      by_account:
        additionalProperties:
          $ref: '#/definitions/models.AccountPnL'
        type: object
      by_asset:
        additionalProperties:
          $ref: '#/definitions/models.AssetPnL'
        type: object
      period:
        $ref: '#/definitions/models.Period'
      realized_pnl_usd:
        type: number
      realized_pnl_vnd:
        type: number
      roi_percent:
        type: number
      total_pnl_usd:
        type: number
      total_pnl_vnd:
        type: number
    type: object
  models.SpendingByDay:
    properties:
      amount_usd:
        type: number
      amount_vnd:
        type: number
      count:
        type: integer
    type: object
  models.SpendingByTag:
    properties:
      amount_usd:
        type: number
      amount_vnd:
        type: number
      count:
        type: integer
      percentage:
        type: number
    type: object
  models.SpendingReport:
    properties:
      by_counterparty:
        additionalProperties:
          $ref: '#/definitions/models.SpendingByTag'
        type: object
      by_day:
        additionalProperties:
          $ref: '#/definitions/models.SpendingByDay'
        description: Daily breakdown of spending (outflows only) keyed by YYYY-MM-DD
        type: object
      by_tag:
        additionalProperties:
          $ref: '#/definitions/models.SpendingByTag'
        type: object
      period:
        $ref: '#/definitions/models.Period'
      top_expenses:
        items:
          $ref: '#/definitions/models.TransactionSummary'
        type: array
      total_usd:
        type: number
      total_vnd:
        type: number
    type: object
  models.Transaction:
    properties:
      account:
        type: string
      amount_local:
        description: Amount fields
        type: number
      asset:
        type: string
      borrow_active:
        type: boolean
      borrow_apr:
        description: Borrow metadata (for type = 'borrow')
        type: number
      borrow_term_days:
        type: integer
      cashflow_local:
        type: number
      counterparty:
        type: string
      created_at:
        description: Audit fields
        type: string
      date:
        type: string
      delta_qty:
        description: Derived metrics
        type: number
      entry_date:
        type: string
      exit_date:
        type: string
      fee_local:
        description: Fees (stored in local currency, will be converted dynamically)
        type: number
      horizon:
        description: Optional tracking
        type: string
      id:
        type: string
      internal_flow:
        description: Flow flags
        type: boolean
      investment_id:
        description: Enhanced investment tracking - links transaction to investment
          position
        type: string
      local_currency:
        type: string
      note:
        type: string
      price_local:
        type: number
      quantity:
        description: Amount fields
        type: number
      tag:
        type: string
      type:
        type: string
      updated_at:
        type: string
    type: object
  models.TransactionSummary:
    properties:
      account:
        type: string
      amount_usd:
        type: number
      amount_vnd:
        type: number
      asset:
        type: string
      counterparty:
        type: string
      date:
        type: string
      id:
        type: string
      note:
        type: string
      tag:
        type: string
      type:
        type: string
    type: object
  models.TransactionWithFX:
    properties:
      account:
        type: string
      amount_local:
        description: Amount fields
        type: number
      asset:
        type: string
      borrow_active:
        type: boolean
      borrow_apr:
        description: Borrow metadata (for type = 'borrow')
        type: number
      borrow_term_days:
        type: integer
      cashflow_local:
        type: number
      counterparty:
        type: string
      created_at:
        description: Audit fields
        type: string
      date:
        type: string
      delta_qty:
        description: Derived metrics
        type: number
      entry_date:
        type: string
      exit_date:
        type: string
      fee_local:
        description: Fees (stored in local currency, will be converted dynamically)
        type: number
      fx_rates:
        additionalProperties:
          type: number
        description: 'Map of currency pairs to rates, e.g., "USD-VND": 24000'
        type: object
      horizon:
        description: Optional tracking
        type: string
      id:
        type: string
      internal_flow:
        description: Flow flags
        type: boolean
      investment_id:
        description: Enhanced investment tracking - links transaction to investment
          position
        type: string
      local_currency:
        type: string
      note:
        type: string
      price_local:
        type: number
      quantity:
        description: Amount fields
        type: number
      tag:
        type: string
      type:
        type: string
      updated_at:
        type: string
    type: object
  models.VaultTransaction:
    properties:
      account:
        type: string
      amount_usd:
        description: Financial amounts
        type: number
      asset:
        description: Asset information (for rebalancing and asset-specific transactions)
        type: string
      asset_price:
        type: number
      asset_quantity:
        type: number
      created_at:
        type: string
      created_by:
        description: Audit fields
        type: string
      executed_at:
        type: string
      external_tx_id:
        type: string
      fee_amount:
        description: Fee information
        type: number
      fee_rate:
        type: number
      fee_type:
        type: string
      id:
        type: string
      notes:
        type: string
      price_per_share:
        type: number
      share_price_after:
        type: number
      share_price_before:
        type: number
      shares:
        type: number
      status:
        type: string
      timestamp:
        description: Metadata
        type: string
      transaction_hash:
        type: string
      type:
        allOf:
        - $ref: '#/definitions/models.VaultTransactionType'
        description: Transaction details
      updated_at:
        type: string
      user_id:
        type: string
      user_shares_after:
        type: number
      user_shares_before:
        description: User balance snapshots
        type: number
      vault_aum_after:
        type: number
      vault_aum_before:
        description: Price and valuation information
        type: number
      vault_id:
        type: string
    type: object
  models.VaultTransactionType:
    enum:
    - deposit
    - withdrawal
    - mint_shares
    - burn_shares
    - rebalance
    - fee
    - yield
    - income
    - expense
    - valuation
    type: string
    x-enum-varnames:
    - VaultTxTypeDeposit
    - VaultTxTypeWithdrawal
    - VaultTxTypeMintShares
    - VaultTxTypeBurnShares
    - VaultTxTypeRebalance
    - VaultTxTypeFee
    - VaultTxTypeYield
    - VaultTxTypeIncome
    - VaultTxTypeExpense
    - VaultTxTypeValuation
info:
  contact: {}
  description: API documentation for Nami Transaction Tracking System.
  title: Nami Backend API
  version: "1.0"
paths:
  /actions:
    post:
      consumes:
      - application/json
      description: Perform a domain-specific action
      parameters:
      - description: Action request
        in: body
        name: action
        required: true
        schema:
          $ref: '#/definitions/models.ActionRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.ActionResponse'
        "400":
          description: Bad request
          schema:
            type: string
      summary: Perform an action
      tags:
      - actions
  /fx/history:
    get:
      description: Get daily FX rates for a period
      parameters:
      - description: Base currency (default USD)
        in: query
        name: from
        type: string
      - description: Quote currency (default VND)
        in: query
        name: to
        type: string
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get FX history
      tags:
      - fx
  /fx/today:
    get:
      description: Fetch today's FX rate for a currency pair, cache it, and return
      parameters:
      - description: Base currency (default USD)
        in: query
        name: from
        type: string
      - description: Quote currency (default VND)
        in: query
        name: to
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get today's FX rate (fetched and stored)
      tags:
      - fx
  /investments:
    get:
      consumes:
      - application/json
      description: Retrieve investments based on filter criteria
      parameters:
      - description: Filter by asset
        in: query
        name: asset
        type: string
      - description: Filter by account
        in: query
        name: account
        type: string
      - description: Filter by horizon
        in: query
        name: horizon
        type: string
      - description: Filter by open status
        in: query
        name: is_open
        type: boolean
      - description: Limit results
        in: query
        name: limit
        type: integer
      - description: Offset results
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Investment'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investments
      tags:
      - investments
  /investments/{id}:
    get:
      consumes:
      - application/json
      description: Retrieve a specific investment by ID
      parameters:
      - description: Investment ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Investment'
        "404":
          description: Investment not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investment by ID
      tags:
      - investments
  /investments/available:
    get:
      consumes:
      - application/json
      description: Retrieve open investments available for stake operations
      parameters:
      - description: Asset
        in: query
        name: asset
        required: true
        type: string
      - description: Account
        in: query
        name: account
        required: true
        type: string
      - description: Horizon
        in: query
        name: horizon
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Investment'
            type: array
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get available investments for stake
      tags:
      - investments
  /investments/stake:
    post:
      consumes:
      - application/json
      description: Process a stake transaction and create/update investment
      parameters:
      - description: Stake transaction
        in: body
        name: stake
        required: true
        schema:
          $ref: '#/definitions/models.Transaction'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Investment'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Create stake investment
      tags:
      - investments
  /investments/summary:
    get:
      consumes:
      - application/json
      description: Retrieve investment summary statistics
      parameters:
      - description: Filter by asset
        in: query
        name: asset
        type: string
      - description: Filter by account
        in: query
        name: account
        type: string
      - description: Filter by horizon
        in: query
        name: horizon
        type: string
      - description: Filter by open status
        in: query
        name: is_open
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.InvestmentSummary'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get investment summary
      tags:
      - investments
  /investments/unstake:
    post:
      consumes:
      - application/json
      description: Process an unstake transaction and update investment. The field
        `investment_id` is required and must reference an existing open investment.
      parameters:
      - description: Unstake transaction (requires investment_id)
        in: body
        name: unstake
        required: true
        schema:
          $ref: '#/definitions/models.Transaction'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Investment'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Create unstake investment
      tags:
      - investments
  /prices/daily:
    get:
      description: Get daily prices for a symbol or asset ID in a currency
      parameters:
      - description: Asset symbol (e.g., BTC)
        in: query
        name: symbol
        type: string
      - description: Asset ID
        in: query
        name: asset_id
        type: string
      - description: Target currency (default USD)
        in: query
        name: currency
        type: string
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get daily asset prices
      tags:
      - prices
  /reports/borrows/outstanding:
    get:
      description: Get list of outstanding borrows as of a date
      parameters:
      - description: As of date (YYYY-MM-DD)
        in: query
        name: as_of
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.OutstandingBorrow'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get outstanding borrows
      tags:
      - reports
  /reports/cashflow:
    get:
      description: Get cash flow over a period
      parameters:
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Days back from end_date
        in: query
        name: days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.CashFlowReport'
        "400":
          description: Invalid period parameters
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get cash flow report
      tags:
      - reports
  /reports/expected-borrow-outflows:
    get:
      description: Project remaining principal and interest for active borrows as
        of a date
      parameters:
      - description: As-of date (YYYY-MM-DD)
        in: query
        name: as_of
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.OutflowProjection'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get expected borrow outflows
      tags:
      - reports
  /reports/holdings:
    get:
      description: Get current holdings as of a date with portfolio percentages
      parameters:
      - description: As of date (YYYY-MM-DD)
        in: query
        name: as_of
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Holding'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get holdings
      tags:
      - reports
  /reports/holdings/summary:
    get:
      description: Get aggregated holdings summary as of a date with portfolio percentages
      parameters:
      - description: As of date (YYYY-MM-DD)
        in: query
        name: as_of
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.HoldingSummary'
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get holdings summary
      tags:
      - reports
  /reports/pnl:
    get:
      description: Get profit and loss over a period
      parameters:
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Days back from end_date
        in: query
        name: days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.PnLReport'
        "400":
          description: Invalid period parameters
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get PnL report
      tags:
      - reports
  /reports/spending:
    get:
      description: Get spending over a period
      parameters:
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Days back from end_date
        in: query
        name: days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.SpendingReport'
        "400":
          description: Invalid period parameters
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get spending report
      tags:
      - reports
  /transactions:
    get:
      consumes:
      - application/json
      description: Get a list of transactions or create a new one
      parameters:
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Comma-separated transaction types
        in: query
        name: types
        type: string
      - description: Comma-separated asset symbols
        in: query
        name: assets
        type: string
      - description: Comma-separated account names
        in: query
        name: accounts
        type: string
      - description: Comma-separated tag names
        in: query
        name: tags
        type: string
      - description: Counterparty name
        in: query
        name: counterparty
        type: string
      - description: Target currencies for FX conversion (comma-separated), defaults
          to USD,VND
        in: query
        name: currencies
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Basic transactions without FX conversion
          schema:
            items:
              $ref: '#/definitions/models.Transaction'
            type: array
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List or create transactions
      tags:
      - transactions
    post:
      consumes:
      - application/json
      description: Get a list of transactions or create a new one
      parameters:
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Comma-separated transaction types
        in: query
        name: types
        type: string
      - description: Comma-separated asset symbols
        in: query
        name: assets
        type: string
      - description: Comma-separated account names
        in: query
        name: accounts
        type: string
      - description: Comma-separated tag names
        in: query
        name: tags
        type: string
      - description: Counterparty name
        in: query
        name: counterparty
        type: string
      - description: Target currencies for FX conversion (comma-separated), defaults
          to USD,VND
        in: query
        name: currencies
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Basic transactions without FX conversion
          schema:
            items:
              $ref: '#/definitions/models.Transaction'
            type: array
        "400":
          description: Invalid request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List or create transactions
      tags:
      - transactions
  /transactions/{id}:
    delete:
      consumes:
      - application/json
      description: Operate on a single transaction by ID
      parameters:
      - description: Transaction ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Transaction'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get, update, or delete a transaction
      tags:
      - transactions
    get:
      consumes:
      - application/json
      description: Operate on a single transaction by ID
      parameters:
      - description: Transaction ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Transaction'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get, update, or delete a transaction
      tags:
      - transactions
    put:
      consumes:
      - application/json
      description: Operate on a single transaction by ID
      parameters:
      - description: Transaction ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Transaction'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get, update, or delete a transaction
      tags:
      - transactions
  /vaults/{vaultId}/assets/{asset}/holdings:
    get:
      description: Get derived holdings for a specific asset/account within a vault
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      - description: Asset symbol
        in: path
        name: asset
        required: true
        type: string
      - description: Account name
        in: query
        name: account
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get asset holdings in a vault (derived)
      tags:
      - vaults
  /vaults/{vaultId}/holdings:
    get:
      description: Get derived vault holdings from transaction ledger
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get vault holdings (derived)
      tags:
      - vaults
  /vaults/{vaultId}/transactions:
    get:
      description: List transactions for a vault (supports limit, offset, type, status)
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      - description: Transaction type
        in: query
        name: type
        type: string
      - description: Status
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.VaultTransaction'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List vault transactions
      tags:
      - vaults
    post:
      consumes:
      - application/json
      description: Create a new transaction recorded in the vault ledger
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      - description: Vault transaction payload
        in: body
        name: payload
        required: true
        schema:
          $ref: '#/definitions/models.VaultTransaction'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.VaultTransaction'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Create a vault transaction
      tags:
      - vaults
  /vaults/{vaultId}/user/{userId}/holdings:
    get:
      description: Get derived user holdings in a vault from transaction ledger
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      - description: User ID
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Get user holdings (derived)
      tags:
      - vaults
  /vaults/{vaultId}/user/{userId}/transactions:
    get:
      description: List transactions for a user in a vault (supports limit, offset)
      parameters:
      - description: Vault ID
        in: path
        name: vaultId
        required: true
        type: string
      - description: User ID
        in: path
        name: userId
        required: true
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.VaultTransaction'
            type: array
        "500":
          description: Internal server error
          schema:
            type: string
      summary: List user transactions in a vault
      tags:
      - vaults
swagger: "2.0"
